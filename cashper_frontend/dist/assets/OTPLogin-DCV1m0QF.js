import{u as I,r as n,j as e,L as v,y as o}from"./index-yrnWZ-a-.js";import{m as N,v as F}from"./api-BrxIySwa.js";import{A as R}from"./arrow-left-DiYeyS6s.js";import{P as M}from"./phone-CqcdPlAf.js";import{C as _}from"./circle-alert-Dkr8_vtj.js";import{c as $}from"./createLucideIcon-CjEx-mil.js";import{C as A}from"./circle-check-big-rPkRElWp.js";const B=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],w=$("loader-circle",B),H=()=>{const g=I(),[m,b]=n.useState(1),[a,P]=n.useState(""),[c,u]=n.useState(["","","","","",""]),[d,i]=n.useState(!1),[x,h]=n.useState(60),[y,f]=n.useState(!1),[p,O]=n.useState({}),l=n.useRef([]);n.useEffect(()=>{if(m===2&&x>0){const t=setInterval(()=>{h(s=>s<=1?(f(!0),0):s-1)},1e3);return()=>clearInterval(t)}},[m,x]);const T=()=>{const t={};return a?/^[6-9]\d{9}$/.test(a)||(t.phone="Please enter a valid 10-digit mobile number"):t.phone="Phone number is required",O(t),Object.keys(t).length===0},C=async t=>{if(t.preventDefault(),!!T()){i(!0);try{await N(a),o.success("OTP sent to your mobile number!",{position:"top-right",autoClose:3e3}),b(2),h(60),f(!1)}catch(s){o.error(s.response?.data?.detail||"Failed to send OTP. Please try again.",{position:"top-right",autoClose:3e3})}finally{i(!1)}}},S=async()=>{if(y){i(!0);try{await N(a),o.success("OTP resent successfully!",{position:"top-right",autoClose:3e3}),h(60),f(!1),u(["","","","","",""]),l.current[0]?.focus()}catch(t){o.error(t.response?.data?.detail||"Failed to resend OTP",{position:"top-right",autoClose:3e3})}finally{i(!1)}}},k=(t,s)=>{if(!/^\d*$/.test(s))return;const r=[...c];r[t]=s,u(r),s&&t<5&&l.current[t+1]?.focus()},L=(t,s)=>{s.key==="Backspace"&&!c[t]&&t>0&&l.current[t-1]?.focus()},E=t=>{t.preventDefault();const s=t.clipboardData.getData("text").slice(0,6);if(!/^\d+$/.test(s))return;const r=s.split("").concat(["","","","","",""]).slice(0,6);u(r);const j=s.length-1;j<5&&l.current[j+1]?.focus()},D=async t=>{t.preventDefault(),t.stopPropagation();const s=c.join("");if(s.length!==6){o.error("Please enter complete 6-digit OTP",{position:"top-right",autoClose:3e3});return}i(!0);try{const r=await F(a,s);localStorage.setItem("access_token",r.access_token),r.user&&localStorage.setItem("user",JSON.stringify(r.user)),o.success("Login successful!",{position:"top-right",autoClose:1500}),setTimeout(()=>{r.user?.email==="sudha@gmail.com"?g("/admin",{replace:!0}):g("/dashboard",{replace:!0})},100)}catch(r){o.error(r.response?.data?.detail||"Invalid OTP. Please try again.",{position:"top-right",autoClose:3e3}),u(["","","","","",""]),l.current[0]?.focus(),i(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-green-50 via-emerald-50 to-teal-50 py-8 px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 px-6 sm:px-8 py-6 sm:py-8",children:[e.jsxs(v,{to:"/login",className:"inline-flex items-center text-white/90 hover:text-white mb-4 transition-colors",children:[e.jsx(R,{className:"h-5 w-5 mr-2"}),e.jsx("span",{className:"text-sm",children:"Back to Login"})]}),e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-white",children:"Mobile OTP Login"}),e.jsx("p",{className:"mt-2 text-sm text-white/90",children:m===1?"Enter your mobile number to receive OTP":"Enter the 6-digit OTP sent to your mobile"})]}),e.jsxs("div",{className:"px-6 sm:px-8 py-6 sm:py-8",children:[m===1?e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Mobile Number"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(M,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"tel",id:"phone",value:a,onChange:t=>P(t.target.value),className:`block w-full pl-10 pr-3 py-3 text-base border ${p.phone?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all outline-none`,placeholder:"9876543210",maxLength:"10"})]}),p.phone&&e.jsxs("div",{className:"flex items-center mt-1 text-red-500 text-sm",children:[e.jsx(_,{className:"h-4 w-4 mr-1"}),p.phone]}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"We'll send a 6-digit OTP to verify your number"})]}),e.jsx("button",{type:"submit",disabled:d,className:"w-full flex justify-center items-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-base font-medium text-white bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:d?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"animate-spin -ml-1 mr-2 h-5 w-5"}),"Sending OTP..."]}):"Send OTP"})]}):e.jsxs("form",{onSubmit:D,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Enter OTP"}),e.jsx("button",{type:"button",onClick:()=>b(1),className:"text-sm text-green-600 hover:text-green-700",children:"Change Number"})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:e.jsxs("p",{className:"text-sm text-gray-600 text-center",children:["OTP sent to ",e.jsxs("span",{className:"font-semibold text-gray-900",children:["+91 ",a]})]})}),e.jsx("div",{className:"flex justify-center gap-2 sm:gap-3",children:c.map((t,s)=>e.jsx("input",{ref:r=>l.current[s]=r,type:"text",inputMode:"numeric",maxLength:"1",value:t,onChange:r=>k(s,r.target.value),onKeyDown:r=>L(s,r),onPaste:E,className:"w-12 h-12 sm:w-14 sm:h-14 text-center text-xl font-semibold border-2 border-gray-300 rounded-lg focus:border-green-500 focus:ring-2 focus:ring-green-500 focus:outline-none transition-all"},s))}),e.jsx("div",{className:"mt-4 text-center",children:y?e.jsx("button",{type:"button",onClick:S,disabled:d,className:"text-sm font-medium text-green-600 hover:text-green-700 disabled:opacity-50",children:"Resend OTP"}):e.jsxs("p",{className:"text-sm text-gray-600",children:["Resend OTP in ",e.jsxs("span",{className:"font-semibold text-green-600",children:[x,"s"]})]})})]}),e.jsx("button",{type:"submit",disabled:d||c.join("").length!==6,className:"w-full flex justify-center items-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-base font-medium text-white bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:d?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"animate-spin -ml-1 mr-2 h-5 w-5"}),"Verifying..."]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-5 w-5 mr-2"}),"Verify & Login"]})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-xs",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or"})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(v,{to:"/login",className:"text-sm font-medium text-green-600 hover:text-green-700 transition-colors",children:"Login with Email & Password"})})]})]})]})})})};export{H as default};
//# sourceMappingURL=OTPLogin-DCV1m0QF.js.map
